{% extends 'base.html' %}
{% load static %}
{% load business_type_filter %}
{% block title %}CrowdSourceIt - Projects{% endblock title %}
{% block content %}
	<header id="featured" class="site-featured">
		<div id="featured-media" class="featured-media has-media">
			<div class="featured-text">
				<div class="container">
					<h2 class="entry-title">Projects</h2>
					<div class="tagline">We make investing easier.</div>
				</div>
			</div>
			<img src="tmp/sample-header.jpg" alt="">
		</div>
	</header>

	<div id="content" class="site-content">
		<main class="site-section section-main">
			<div class="container">
				<form action="{% url 'projects' %}" class="project-filters" method="GET">
					<div class="filter-props">
						<!-- <p class="project-filter filter-status">
							<label>Status</label>
							<select name="status" id="status">
								<option value="new" selected="selected">New</option>
								<option value="coming-soon">Coming soon</option>
								<option value="funded">Funded</option>
								<option value="repaid">Repaid</option>
							</select>
						</p> -->
							<p class="project-filter filter-return">
								<label>Expected Return Rate (ROI)</label>
								<input class="minReturn" name="from_expected_return" type="text" placeholder="From" value="{% if from_expected_return %}{{ from_expected_return }}{% endif %}">
								<input class="maxReturn" name="to_expected_return" type="text" placeholder="To" value="{% if to_expected_return %}{{ to_expected_return }}{% endif %}">
								<button type="submit" class="button button-primary button-default"><em class="mdi mdi-filter"></em>Filter Result</button>
							</p>
						<!-- <p class="project-filter filter-country">
							<label>Country</label>
							<select name="country" id="country">
								<option value="">All</option>
								<option value="es">Estonia</option>
								<option value="lv">Latvia</option>
								<option value="lt">Lithuania</option>
								<option value="world">Worldwide</option>
							</select>
						</p> -->
						<!-- <p class="project-filter filter-type">
							<label>Loan type</label>
							<select name="type" id="type">
								<option value="">All</option>
								<option value="business">Business</option>
								<option value="sme">SME</option>
								<option value="leasing">Leasing</option>
								<option value="realestate">Real estate</option>
							</select>
						</p> -->
					</div>
					<!-- <div class="filter-actions">
						<button name="filter" type="submit" class="button-primary"><em class="mdi mdi-filter"></em> Filter projects</button>
						<button type="reset"><em class="mdi mdi-restart"></em> Reset filters</button>
					</div> -->
				</form>
				<div class="project-listing">
                    {% for project in projects %}
					<div class="entry-project project-status-active">
						<div class="project-media">
							<a href="{% url 'project_details' project.pk %}">
								<img src="{{ project.image_1.url }}" width="800" height="600" alt="">
								<span class="project-industry" title="Investment type"><em class="mdi mdi-information"></em> Business &mdash; 
									
										{{ project.business_type|title }}
								</span>
								<span class="project-country" title="Estonia"><img class="office-country" src="assets/images/ee.svg" width="24" alt=""> <em class="screen-reader-text">{{ project.country }}</em></span>
							</a>
							<span class="project-status"><em class="mdi mdi-plus"></em>
								{% if project.status is None %}
								Yet to be Reviewed
								{% else %}
								{{ project.status }}
								{% endif %}
							</span>
						</div>
						<div class="project-details">
							<h3 class="project-title"><a href="{% url 'project_details' project.pk %}">{{ project.name|title }}</a></h3>
							<p class="project-summary">{{ project.description }}</p>
							<div class="project-specs">
								<div class="project-total-invested">
									<strong><span class="currency-sign">₦</span>{{ project.target }}</strong>
									<span>Target</span>
								</div>
								<div class="project-return">
									<strong>{{ project.expected_return }}%</strong>
									<span>Expected return</span>
								</div>
								<div class="project-term">
									<strong>{{ project.term_months }} months</strong>
									<span>Term</span>
								</div>
								<div class="project-countdown">
									<strong>{{ project.investment_deadline }}</strong>
									<span>Investment Deadline</span>
								</div>
							</div>
							<div class="project-progress">
								<div class="progress-bar">
									<div class="progress-current" style="width:48.665%"></div>
									<div class="progress-minimum" style="width:62.5%">
										<div class="progress-minimum-pointer">
											<span class="project-minimum-goal-info">Min<span class="screen-reader-text">imum</span> goal</span>
											<span class="project-minimum-goal-amount"><span class="currency-sign">₦</span>25 000</span>
										</div>
									</div>
								</div>
								<div class="progress-info">
									<div class="progress-current-amount"><strong><span class="currency-sign">₦</span>
										{% if project.fund_raised  %}
										{{ project.fund_raised }}
										{% else %}
										0
										{% endif %}
									</strong> invested</div>
									<div class="progress-amount-left"><strong><span class="currency-sign">₦</span>
										{% if project.amount_left is None %}
										{{ project.target }}
										{% else %}
										0
										{% endif %}
									</strong> left
									</div>
								</div>
							</div>
							<div class="project-actions">
								<a href="{% url 'project_details' project.pk %}" class="button button-primary">Details</a>
							</div>
						</div>
					</div>
                    {% endfor %}
				</div>
				<div class="d-flex flex-column m-auto pagination mt-5">
					<nav aria-label="Page navigation">
					{% if from_expected_return %}
						<ul class="pagination pg-grey justify-content-center" style="list-style: none;display: inline;">
							{% if projects.has_previous %}
								<li class="page-item" style="display: inline;">
								<a class="page-numbers" href="?{% if query %}query={{query}}&{% endif %}&page={{projects.previous_page_number}}">Previous</a>
								</li>
							{% endif %}
						
							{% for i in projects.paginator.page_range %}
								{% if projects.number == i %}
									<li class="page-item active" style="display: inline;"><a class="page-link">
										<span class="page-numbers current">
											{{ i }}
											<span class="sr-only">(current)</span>
										</span>
									</a></li>
								{% else %}
									<li class="page-item" style="display: inline;"><a class="page-numbers" href="?{% if query %}query={{query}}&{% endif %}page={{ i }}">{{ i }}</a></li>
								{% endif %}
							{% endfor %}
							
							{% if projects.has_next %}
								<li class="page-item" style="display: inline;">
								<a class="page-numbers" href="?{% if query %}query={{query}}&{% endif %}page={{ projects.next_page_number }}">Next
									
								</a>
								</li>
								<li class="page-item" style="display: inline;">
								<a class="page-numbers"  href="?{% if query %}query={{query}}&{% endif %}page={{ projects.paginator.num_pages }}">Last</a>
								</li>
							{% endif %}
						</ul>
						{% else %}
						<ul class="pagination pg-grey justify-content-center" style="list-style: none;display: inline;">
							{% if projects.has_previous %}
								<li class="page-item" style="display: inline;">
								<a class="page-numbers" href="?page={{projects.previous_page_number}}">Previous</a>
								</li>
							{% endif %}
						
							{% for i in projects.paginator.page_range %}
								{% if projects.number == i %}
									<li class="page-item active" style="display: inline;"><a class="page-link">
										<span class="page-numbers current">
											{{ i }}
											<span class="sr-only">(current)</span>
										</span>
									</a></li>
								{% else %}
									<li class="page-item" style="display: inline;"><a class="page-numbers" href="?page={{ i }}">{{ i }}</a></li>
								{% endif %}
							{% endfor %}
							
							{% if projects.has_next %}
								<li class="page-item" style="display: inline;">
								<a class="page-numbers" href="?page={{ projects.next_page_number }}">Next
									
								</a>
								</li>
								<li class="page-item" style="display: inline;">
								<a class="page-numbers"  href="?page={{ projects.paginator.num_pages }}">Last</a>
								</li>
							{% endif %}
						</ul>
						{% endif %}
					</nav>
				</div>
			</div>
		</main>
	</div>
{% endblock content %}