{% extends 'base.html' %}
{% load static %}
{% block title %}Fund or Withdraw{% endblock title %}
{% block content %}

<div class="container">
    <div class="tab-container style-minimal">
        <ul class="tabs clearfix">
            <li><a href="#tab-deposit" class="tab-link-active">Deposit</a></li>
            <li><a href="#tab-withdraw">Withdraw</a></li>
        </ul>
        <div id="tab-deposit" class="tab-content tab-active">
            <div class="row">
                <div class="col-12 col-lg-9">
                    <script src="https://js.paystack.co/v1/inline.js"></script>
                    <form class="mb-4" method="POST" id="payForm" action="{% url 'deposit' %}">
                        {% csrf_token %}
                        <input type="text" id="hide" style="visibility: hidden;" value="False" name="bool">
                        <p>To begin investing you need to deposit funds to your Investor Account by making transfer to the bank account stated below. Processing may take up to 2-3 working days. Once deposited funds are added to your Investor Account, you will receive a confirmation e-mail and will be able to make investments.</p>
                        <input type="number" step="0.1" min=0 placeholder="Amount" name="amount" id="amount">
                        <button onclick="makePayment()" name="deposit" type="button">Deposit</button>
                    </form>
                </div>
            </div>
        </div>
        <div id="tab-withdraw" class="tab-content">
            <div class="row">
                <div class="col-12 col-lg-9">
                    <form action="{% url 'deposit' %}" method="POST">
                        {% csrf_token %}
                        <div class="data-box">
                            <div class="data-property">Withdraw Amount</div>
                            <div class="data-value"><input name="withdraw_amount" type="number" step="0.1" min=0></div>
                            
                            <div class="data-property">Account Number</div>
                            <div class="data-value"><input name="withdraw_to" type="number"></div>
                            <select class="data-value form-select form-select-sm " aria-label=".form-select-sm example" style="font-weight: normal;">
                                <option selected>Select Bank</option>
                                {% for  %}
                                <option value="1">One</option>
                                <option value="2">Two</option>
                                <option value="3">Three</option>
                            </select>

                            <div class="data-property">Available Funds</div>
                            <div class="data-value">â‚¦ {{ innovator.account_balance }}</div>
                            <div class="data-actions"><button type="submit">Withdraw</button></div>
                        </div>
                    </form>
                    
                </div>
            </div>
        </div>
        
    </div>
</div>

<script>
    // document.getElementById('make-payment-btn').addEventListener('click', makePayment);
    function makePayment(){
        let amount = document.getElementById('amount').value
    // e.preventDefault();
    let handler = PaystackPop.setup({
            key: 'pk_test_94c9c0292b58b03a1e0feaa5b1b1da81b04b0873', //public key from your paystack
            email: '{{ user.email }}',
            amount:`${amount}` * 100,
            currency:'NGN',
            // ref: ''+Math.floor((Math.random() * 100000000) + 1),
            // ref: ''+Math.floor((Math.random() * 1000000000) + 1),
            callback: function(response){
        document.getElementById('hide').value = 'True';
        
        // document.getElementById('hide').style.visibility = 'visible';
        document.getElementById('payForm').submit();
        alert('Success. Transaction ref is ' +response.reference);
    },
    onClose: function(){
        alert('Window Closed');
    }
    });
    handler.openIframe();
}
// window.onload = makePayment()
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
{% endblock content %}